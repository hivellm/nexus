import{d as U,u as E,r as c,e as H,s as Q,f as F,g as A,c as n,a as e,w as _,v as B,p as K,y as R,C as j,k as d,b as D,t as u,D as q,n as y,F as L,j as S,o as l,E as z}from"./index-CP6pyHN1.js";const O={class:"p-6 space-y-6"},P={class:"card"},W={class:"flex items-center gap-4"},G={class:"flex-1"},J={class:"card"},X={class:"flex items-center justify-between mb-4"},Y={class:"text-lg font-semibold flex items-center gap-2"},Z={key:0,class:"text-sm font-normal text-text-muted"},$={class:"flex items-center gap-2"},ee={class:"flex items-center gap-2 text-sm text-text-secondary"},te={key:0,class:"space-y-1"},se={class:"text-text-muted mr-2"},ae={class:"text-text-primary"},oe={key:0,class:"text-text-muted ml-2"},ne={key:1,class:"text-center text-text-muted py-8"},le={class:"card"},re={key:0,class:"overflow-x-auto"},ue={class:"table"},ie={class:"text-text-muted text-xs"},ce={class:"font-mono text-xs max-w-md truncate"},de={class:"text-sm"},me={class:"text-sm"},ve={key:1,class:"text-center text-text-muted py-8"},xe=U({__name:"LogsView",setup(fe){const T=E(),i=c([]),f=c([]),p=c(""),x=c(""),w=c(!1),b=c(!0),g=c(null);let h=null;const C=H(()=>i.value.filter(a=>!(x.value&&a.level!==x.value||p.value&&!a.message.toLowerCase().includes(p.value.toLowerCase()))));async function m(){var t,s;const a=T.activeClient;if(a){w.value=!0;try{const o=await((t=a.getLogs)==null?void 0:t.call(a));o!=null&&o.success&&o.data&&(i.value=o.data.map(r=>({timestamp:new Date(r.timestamp),level:r.level||"info",message:r.message,source:r.source})));const v=await((s=a.getQueryHistory)==null?void 0:s.call(a));v!=null&&v.success&&v.data&&(f.value=v.data.map(r=>({timestamp:new Date(r.timestamp),query:r.query,duration:r.duration,rowCount:r.rowCount,success:r.success})))}catch(o){console.error("Failed to load logs:",o),M()}finally{w.value=!1}}}function M(){i.value=[{timestamp:new Date,level:"info",message:"Server started on port 7687",source:"main"},{timestamp:new Date(Date.now()-6e4),level:"info",message:"Connection accepted from 127.0.0.1",source:"network"},{timestamp:new Date(Date.now()-12e4),level:"debug",message:"Query executed: MATCH (n) RETURN n LIMIT 10",source:"query"},{timestamp:new Date(Date.now()-18e4),level:"info",message:"Index created on :Person(name)",source:"storage"},{timestamp:new Date(Date.now()-24e4),level:"warn",message:"Memory usage above 80%",source:"monitor"}]}function V(){i.value=[],f.value=[]}function k(a){return new Date(a).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})}function I(a){switch(a){case"error":return"bg-error/5";case"warn":return"bg-warning/5";default:return""}}function N(a){switch(a){case"error":return"text-error";case"warn":return"text-warning";case"info":return"text-info";case"debug":return"text-text-muted";default:return"text-text-secondary"}}return Q(C,async()=>{b.value&&g.value&&(await z(),g.value.scrollTop=g.value.scrollHeight)}),F(()=>{m(),h=setInterval(m,5e3)}),A(()=>{h&&clearInterval(h)}),(a,t)=>(l(),n("div",O,[e("div",P,[e("div",W,[e("div",G,[_(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>p.value=s),type:"text",class:"input",placeholder:"Search logs...",onKeydown:K(m,["enter"])},null,544),[[B,p.value]])]),_(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>x.value=s),class:"input w-32"},[...t[3]||(t[3]=[j('<option value="">All Levels</option><option value="error">Error</option><option value="warn">Warning</option><option value="info">Info</option><option value="debug">Debug</option>',5)])],512),[[R,x.value]]),e("button",{onClick:m,class:"btn btn-primary"},[...t[4]||(t[4]=[e("i",{class:"fas fa-search mr-1"},null,-1),d(" Search ",-1)])]),e("button",{onClick:V,class:"btn btn-secondary"},[...t[5]||(t[5]=[e("i",{class:"fas fa-trash mr-1"},null,-1),d(" Clear ",-1)])])])]),e("div",J,[e("div",X,[e("h3",Y,[t[6]||(t[6]=e("i",{class:"fas fa-stream text-info"},null,-1)),t[7]||(t[7]=d(" Server Logs ",-1)),i.value.length>0?(l(),n("span",Z," ("+u(i.value.length)+" entries) ",1)):D("",!0)]),e("div",$,[e("label",ee,[_(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>b.value=s),type:"checkbox",class:"rounded bg-bg-tertiary border-border text-accent"},null,512),[[q,b.value]]),t[8]||(t[8]=d(" Auto-scroll ",-1))]),e("button",{onClick:m,class:"btn btn-secondary text-xs"},[e("i",{class:y(["fas mr-1",w.value?"fa-spinner fa-spin":"fa-sync"])},null,2),t[9]||(t[9]=d(" Refresh ",-1))])])]),e("div",{ref_key:"logContainer",ref:g,class:"bg-bg-tertiary rounded-lg p-4 font-mono text-sm h-[calc(100vh-300px)] overflow-y-auto"},[i.value.length>0?(l(),n("div",te,[(l(!0),n(L,null,S(C.value,(s,o)=>(l(),n("div",{key:o,class:y(["py-1 px-2 rounded",I(s.level)])},[e("span",se,u(k(s.timestamp)),1),e("span",{class:y([N(s.level),"mr-2 uppercase font-semibold text-xs"])}," ["+u(s.level)+"] ",3),e("span",ae,u(s.message),1),s.source?(l(),n("span",oe,"- "+u(s.source),1)):D("",!0)],2))),128))])):(l(),n("div",ne,[...t[10]||(t[10]=[e("i",{class:"fas fa-scroll text-2xl mb-2"},null,-1),e("p",null,"No logs available",-1)])]))],512)]),e("div",le,[t[13]||(t[13]=e("h3",{class:"text-lg font-semibold mb-4 flex items-center gap-2"},[e("i",{class:"fas fa-history text-success"}),d(" Query History ")],-1)),f.value.length>0?(l(),n("div",re,[e("table",ue,[t[11]||(t[11]=e("thead",null,[e("tr",null,[e("th",null,"Timestamp"),e("th",null,"Query"),e("th",null,"Duration"),e("th",null,"Rows"),e("th",null,"Status")])],-1)),e("tbody",null,[(l(!0),n(L,null,S(f.value,(s,o)=>(l(),n("tr",{key:o},[e("td",ie,u(k(s.timestamp)),1),e("td",ce,u(s.query),1),e("td",de,u(s.duration)+"ms",1),e("td",me,u(s.rowCount),1),e("td",null,[e("span",{class:y(["px-2 py-0.5 rounded text-xs",s.success?"bg-success/20 text-success":"bg-error/20 text-error"])},u(s.success?"OK":"Error"),3)])]))),128))])])])):(l(),n("div",ve,[...t[12]||(t[12]=[e("i",{class:"fas fa-history text-2xl mb-2"},null,-1),e("p",null,"No query history",-1)])]))])]))}});export{xe as default};
