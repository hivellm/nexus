import{d as $,u as D,p as O,r as x,C as R,f as F,a as n,b as e,i as f,x as L,q as k,z as _,F as y,l as b,t as u,v as U,n as w,e as A,o as r}from"./index-BG-UUOg-.js";const V={class:"p-6 space-y-6"},B={class:"card"},P=["value"],q={class:"flex items-end"},M=["disabled"],j={class:"card"},H={class:"flex items-center justify-between mb-4"},X={key:0,class:"overflow-x-auto"},z={class:"table"},W={class:"font-mono text-sm"},Q={class:"px-2 py-0.5 bg-info/20 text-info rounded text-xs"},G={class:"flex flex-wrap gap-1"},J={class:"text-sm text-text-secondary"},K=["onClick"],Y={key:1,class:"text-center text-text-muted py-8"},Z={class:"card"},ee={key:0,class:"overflow-x-auto"},te={class:"table"},se={class:"font-mono text-sm"},le={class:"text-sm"},ne={class:"px-2 py-0.5 bg-info/20 text-info rounded text-xs"},re={class:"flex flex-wrap gap-1"},oe=["onClick"],ae={key:1,class:"text-center text-text-muted py-8"},de=$({__name:"IndexesView",setup(ie){const m=D(),d=O(),C=x([]),h=x([]),N=x([]),v=x(!1),g=x(!1),o=R({label:"",property:"",type:"btree"});async function c(){const l=m.activeClient;if(l){v.value=!0;try{const t=await l.executeCypher("SHOW INDEXES");t.success&&t.data&&(C.value=t.data.rows.map(a=>{var p;return{name:a.name,label:((p=a.labelsOrTypes)==null?void 0:p[0])||"",properties:a.properties||[],type:a.type||"BTREE",state:a.state||"ONLINE"}}));const s=await l.executeCypher("SHOW CONSTRAINTS");s.success&&s.data&&(h.value=s.data.rows.map(a=>{var p;return{name:a.name,type:a.type||"UNIQUENESS",label:((p=a.labelsOrTypes)==null?void 0:p[0])||"",properties:a.properties||[]}}));const i=await l.getLabels();i.success&&i.data&&(N.value=i.data.map(a=>a.name))}catch(t){console.error("Failed to load indexes:",t)}finally{v.value=!1}}}async function S(){const l=m.activeClient;if(l){g.value=!0;try{const t=`CREATE INDEX FOR (n:${o.label}) ON (n.${o.property})`,s=await l.executeCypher(t);s.success?(d.success("Index created",`Created index on ${o.label}.${o.property}`),o.label="",o.property="",c()):d.error("Failed to create index",s.error||"Unknown error")}catch(t){d.error("Error",t.message)}finally{g.value=!1}}}async function I(l){const t=m.activeClient;if(t&&confirm(`Are you sure you want to drop index "${l}"?`))try{const s=await t.executeCypher(`DROP INDEX ${l}`);s.success?(d.success("Index dropped",`Dropped index ${l}`),c()):d.error("Failed to drop index",s.error||"Unknown error")}catch(s){d.error("Error",s.message)}}async function E(l){const t=m.activeClient;if(t&&confirm(`Are you sure you want to drop constraint "${l}"?`))try{const s=await t.executeCypher(`DROP CONSTRAINT ${l}`);s.success?(d.success("Constraint dropped",`Dropped constraint ${l}`),c()):d.error("Failed to drop constraint",s.error||"Unknown error")}catch(s){d.error("Error",s.message)}}function T(l){switch(l.toLowerCase()){case"online":return"bg-success/20 text-success";case"populating":return"bg-warning/20 text-warning";case"failed":return"bg-error/20 text-error";default:return"bg-bg-tertiary text-text-secondary"}}return F(()=>{c()}),(l,t)=>(r(),n("div",V,[e("div",B,[t[9]||(t[9]=e("div",{class:"flex items-center justify-between mb-4"},[e("h3",{class:"text-lg font-semibold flex items-center gap-2"},[e("i",{class:"fas fa-plus-circle text-success"}),f(" Create Index ")])],-1)),e("form",{onSubmit:L(S,["prevent"]),class:"grid grid-cols-1 md:grid-cols-4 gap-4"},[e("div",null,[t[4]||(t[4]=e("label",{class:"block text-sm text-text-secondary mb-1"},"Label",-1)),k(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>o.label=s),class:"input",required:""},[t[3]||(t[3]=e("option",{value:""},"Select label...",-1)),(r(!0),n(y,null,b(N.value,s=>(r(),n("option",{key:s,value:s},u(s),9,P))),128))],512),[[_,o.label]])]),e("div",null,[t[5]||(t[5]=e("label",{class:"block text-sm text-text-secondary mb-1"},"Property",-1)),k(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>o.property=s),type:"text",class:"input",placeholder:"property_name",required:""},null,512),[[U,o.property]])]),e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm text-text-secondary mb-1"},"Type",-1)),k(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>o.type=s),class:"input"},[...t[6]||(t[6]=[e("option",{value:"btree"},"B-Tree",-1),e("option",{value:"hash"},"Hash",-1),e("option",{value:"fulltext"},"Full-Text",-1)])],512),[[_,o.type]])]),e("div",q,[e("button",{type:"submit",class:"btn btn-primary w-full",disabled:g.value},[e("i",{class:w(["fas mr-1",g.value?"fa-spinner fa-spin":"fa-plus"])},null,2),t[8]||(t[8]=f(" Create Index ",-1))],8,M)])],32)]),e("div",j,[e("div",H,[t[11]||(t[11]=e("h3",{class:"text-lg font-semibold flex items-center gap-2"},[e("i",{class:"fas fa-list-ol text-accent"}),f(" Indexes ")],-1)),e("button",{onClick:c,class:"btn btn-secondary text-xs"},[e("i",{class:w(["fas mr-1",v.value?"fa-spinner fa-spin":"fa-sync"])},null,2),t[10]||(t[10]=f(" Refresh ",-1))])]),C.value.length>0?(r(),n("div",X,[e("table",z,[t[13]||(t[13]=e("thead",null,[e("tr",null,[e("th",null,"Name"),e("th",null,"Label"),e("th",null,"Properties"),e("th",null,"Type"),e("th",null,"State"),e("th",null,"Actions")])],-1)),e("tbody",null,[(r(!0),n(y,null,b(C.value,s=>(r(),n("tr",{key:s.name},[e("td",W,u(s.name),1),e("td",null,[e("span",Q,u(s.label),1)]),e("td",null,[e("div",G,[(r(!0),n(y,null,b(s.properties,i=>(r(),n("span",{key:i,class:"px-2 py-0.5 bg-bg-tertiary rounded text-xs"},u(i),1))),128))])]),e("td",J,u(s.type),1),e("td",null,[e("span",{class:w(["px-2 py-0.5 rounded text-xs",T(s.state)])},u(s.state),3)]),e("td",null,[e("button",{onClick:i=>I(s.name),class:"p-1 text-text-muted hover:text-error",title:"Drop index"},[...t[12]||(t[12]=[e("i",{class:"fas fa-trash"},null,-1)])],8,K)])]))),128))])])])):v.value?A("",!0):(r(),n("div",Y,[...t[14]||(t[14]=[e("i",{class:"fas fa-list-ol text-2xl mb-2"},null,-1),e("p",null,"No indexes found",-1)])]))]),e("div",Z,[t[18]||(t[18]=e("div",{class:"flex items-center justify-between mb-4"},[e("h3",{class:"text-lg font-semibold flex items-center gap-2"},[e("i",{class:"fas fa-lock text-warning"}),f(" Constraints ")])],-1)),h.value.length>0?(r(),n("div",ee,[e("table",te,[t[16]||(t[16]=e("thead",null,[e("tr",null,[e("th",null,"Name"),e("th",null,"Type"),e("th",null,"Label"),e("th",null,"Properties"),e("th",null,"Actions")])],-1)),e("tbody",null,[(r(!0),n(y,null,b(h.value,s=>(r(),n("tr",{key:s.name},[e("td",se,u(s.name),1),e("td",le,u(s.type),1),e("td",null,[e("span",ne,u(s.label),1)]),e("td",null,[e("div",re,[(r(!0),n(y,null,b(s.properties,i=>(r(),n("span",{key:i,class:"px-2 py-0.5 bg-bg-tertiary rounded text-xs"},u(i),1))),128))])]),e("td",null,[e("button",{onClick:i=>E(s.name),class:"p-1 text-text-muted hover:text-error",title:"Drop constraint"},[...t[15]||(t[15]=[e("i",{class:"fas fa-trash"},null,-1)])],8,oe)])]))),128))])])])):(r(),n("div",ae,[...t[17]||(t[17]=[e("i",{class:"fas fa-lock text-2xl mb-2"},null,-1),e("p",null,"No constraints found",-1)])]))])]))}});export{de as default};
