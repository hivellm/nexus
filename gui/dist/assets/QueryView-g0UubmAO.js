import{d as J,p as F,r as Q,c as f,a as o,b as e,e as d,i as y,n as m,t as a,q as V,v as M,s as B,x as H,F as b,l as g,y as S,o as n}from"./index-BG-UUOg-.js";import{u as z}from"./query-rEsvMwX3.js";const K={class:"flex flex-col h-full"},L={class:"flex-shrink-0 border-b border-border"},P={class:"p-4"},D={class:"flex items-center justify-between mb-2"},I={class:"flex items-center gap-2"},U=["disabled"],A=["disabled"],G={class:"monaco-editor-container h-32"},W=["onKeydown"],X={class:"flex items-center justify-between mt-2 text-xs text-text-muted"},Y={key:0},Z={class:"flex-1 flex flex-col min-h-0 p-4"},ee={key:0,class:"mb-4 p-4 bg-error/10 border border-error/20 rounded-lg"},te={class:"mt-1 text-sm text-text-secondary"},se={key:1,class:"flex items-center justify-between mb-4"},oe={class:"flex items-center gap-4"},ne={class:"flex items-center gap-2"},re={class:"text-sm text-text-muted"},le={class:"flex items-center gap-2"},ae={key:2,class:"flex-1 overflow-auto"},ie={class:"table"},ue={key:0,class:"font-mono text-xs"},ce={key:1},de={key:3,class:"flex-1 overflow-auto"},xe={class:"p-4 bg-bg-tertiary rounded-lg font-mono text-sm text-text-primary overflow-auto"},fe={key:4,class:"flex-1 flex items-center justify-center"},ye={key:0,class:"fixed right-0 top-0 bottom-0 w-80 bg-bg-secondary border-l border-border p-4 z-50 shadow-lg"},ve={class:"flex items-center justify-between mb-4"},me={class:"space-y-2 overflow-y-auto h-full pb-20"},pe=["onClick"],be={class:"font-mono text-xs text-text-primary truncate"},ge={class:"flex items-center gap-2 mt-1 text-xs"},_e={class:"text-text-muted"},he={class:"text-text-muted"},je=J({__name:"QueryView",setup(we){const i=z(),_=F(),x=Q("table"),h=Q(!1),p=f({get:()=>i.currentQuery,set:l=>i.setQuery(l)}),r=f(()=>i.lastResult),w=f(()=>i.isExecuting),k=f(()=>i.error),N=f(()=>i.history),C=f(()=>{var l;return(l=r.value)==null?void 0:l.executionTime});async function j(){const l=await i.executeQuery();l&&_.success("Query executed",`${l.rowCount} rows returned`)}function R(){i.setQuery(""),i.clearResult()}function T(l){i.setQuery(l),h.value=!1}function $(l){return l!==null&&typeof l=="object"}async function E(l){if(!r.value)return;let t,s;if(l==="json")t=JSON.stringify(r.value.rows,null,2),s="query-results.json";else{const u=r.value.columns.join(","),c=r.value.rows.map(O=>r.value.columns.map(q=>{const v=O[q];return typeof v=="string"?`"${v.replace(/"/g,'""')}"`:typeof v=="object"?`"${JSON.stringify(v).replace(/"/g,'""')}"`:v}).join(","));t=[u,...c].join(`
`),s="query-results.csv"}try{const u=await S.saveFile({title:"Export Results",defaultPath:s,filters:l==="json"?[{name:"JSON Files",extensions:["json"]}]:[{name:"CSV Files",extensions:["csv"]}]});u&&(await S.writeFile(u,t),_.success("Export complete",`Results saved to ${u}`))}catch(u){_.error("Export failed",u.message)}}return(l,t)=>(n(),o("div",K,[e("div",L,[e("div",P,[e("div",D,[t[7]||(t[7]=e("h3",{class:"text-sm font-medium text-text-secondary"},"Cypher Query",-1)),e("div",I,[e("button",{onClick:R,class:"btn btn-secondary text-xs",disabled:!p.value},[...t[6]||(t[6]=[e("i",{class:"fas fa-eraser mr-1"},null,-1),y(" Clear ",-1)])],8,U),e("button",{onClick:j,class:"btn btn-primary",disabled:w.value||!p.value.trim()},[e("i",{class:m(["fas mr-1",w.value?"fa-spinner fa-spin":"fa-play"])},null,2),y(" "+a(w.value?"Executing...":"Run Query"),1)],8,A)])]),e("div",G,[V(e("textarea",{"onUpdate:modelValue":t[0]||(t[0]=s=>p.value=s),class:"w-full h-full p-3 bg-bg-tertiary text-text-primary font-mono text-sm resize-none focus:outline-none",placeholder:`Enter your Cypher query here...\r
\r
Example: MATCH (n) RETURN n LIMIT 25`,onKeydown:B(H(j,["ctrl"]),["enter"])},null,40,W),[[M,p.value]])]),e("div",X,[t[8]||(t[8]=e("span",null,"Press Ctrl+Enter to execute",-1)),C.value?(n(),o("span",Y,"Last execution: "+a(C.value)+"ms",1)):d("",!0)])])]),e("div",Z,[k.value?(n(),o("div",ee,[t[9]||(t[9]=e("div",{class:"flex items-center gap-2 text-error"},[e("i",{class:"fas fa-exclamation-circle"}),e("span",{class:"font-medium"},"Query Error")],-1)),e("p",te,a(k.value),1)])):d("",!0),r.value?(n(),o("div",se,[e("div",oe,[e("div",ne,[e("button",{onClick:t[1]||(t[1]=s=>x.value="table"),class:m(["px-3 py-1 rounded text-sm",x.value==="table"?"bg-accent text-white":"bg-bg-tertiary text-text-secondary"])},[...t[10]||(t[10]=[e("i",{class:"fas fa-table mr-1"},null,-1),y(" Table ",-1)])],2),e("button",{onClick:t[2]||(t[2]=s=>x.value="json"),class:m(["px-3 py-1 rounded text-sm",x.value==="json"?"bg-accent text-white":"bg-bg-tertiary text-text-secondary"])},[...t[11]||(t[11]=[e("i",{class:"fas fa-code mr-1"},null,-1),y(" JSON ",-1)])],2)]),e("span",re,a(r.value.rowCount)+" rows in "+a(r.value.executionTime)+"ms ",1)]),e("div",le,[e("button",{onClick:t[3]||(t[3]=s=>E("json")),class:"btn btn-secondary text-xs"},[...t[12]||(t[12]=[e("i",{class:"fas fa-download mr-1"},null,-1),y(" Export JSON ",-1)])]),e("button",{onClick:t[4]||(t[4]=s=>E("csv")),class:"btn btn-secondary text-xs"},[...t[13]||(t[13]=[e("i",{class:"fas fa-file-csv mr-1"},null,-1),y(" Export CSV ",-1)])])])])):d("",!0),r.value&&x.value==="table"?(n(),o("div",ae,[e("table",ie,[e("thead",null,[e("tr",null,[(n(!0),o(b,null,g(r.value.columns,s=>(n(),o("th",{key:s},a(s),1))),128))])]),e("tbody",null,[(n(!0),o(b,null,g(r.value.rows,(s,u)=>(n(),o("tr",{key:u},[(n(!0),o(b,null,g(r.value.columns,c=>(n(),o("td",{key:c},[$(s[c])?(n(),o("span",ue,a(JSON.stringify(s[c]).substring(0,100))+a(JSON.stringify(s[c]).length>100?"...":""),1)):(n(),o("span",ce,a(s[c]),1))]))),128))]))),128))])])])):d("",!0),r.value&&x.value==="json"?(n(),o("div",de,[e("pre",xe,a(JSON.stringify(r.value.rows,null,2)),1)])):d("",!0),!r.value&&!k.value?(n(),o("div",fe,[...t[14]||(t[14]=[e("div",{class:"text-center text-text-muted"},[e("i",{class:"fas fa-terminal text-4xl mb-4"}),e("p",null,"Enter a Cypher query and click Run to see results")],-1)])])):d("",!0)]),h.value?(n(),o("div",ye,[e("div",ve,[t[16]||(t[16]=e("h3",{class:"font-semibold"},"Query History",-1)),e("button",{onClick:t[5]||(t[5]=s=>h.value=!1),class:"text-text-muted hover:text-text-primary"},[...t[15]||(t[15]=[e("i",{class:"fas fa-times"},null,-1)])])]),e("div",me,[(n(!0),o(b,null,g(N.value,s=>(n(),o("div",{key:s.id,class:"p-3 bg-bg-tertiary rounded-lg cursor-pointer hover:bg-bg-hover",onClick:u=>T(s.query)},[e("div",be,a(s.query),1),e("div",ge,[e("span",{class:m(s.success?"text-success":"text-error")},[e("i",{class:m(s.success?"fas fa-check":"fas fa-times")},null,2)],2),e("span",_e,a(s.rowCount)+" rows",1),e("span",he,a(s.executionTime)+"ms",1)])],8,pe))),128))])])):d("",!0)]))}});export{je as default};
