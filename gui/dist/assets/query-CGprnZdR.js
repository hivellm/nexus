import{z as H,r as o,e as w,u as I}from"./index-CP6pyHN1.js";const m="nexus-desktop-query-history",v=100,C=H("query",()=>{const a=o("MATCH (n) RETURN n LIMIT 25"),l=o(null),c=o(!1),u=o(null),t=o([]);function p(){try{const e=localStorage.getItem(m);if(e){const n=JSON.parse(e);t.value=n.map(s=>({...s,timestamp:new Date(s.timestamp)}))}}catch(e){console.error("Failed to load query history:",e)}}function i(){try{localStorage.setItem(m,JSON.stringify(t.value.slice(0,v)))}catch(e){console.error("Failed to save query history:",e)}}p();const S=w(()=>t.value.slice(0,10));async function h(e){var f,d;const s=I().activeClient;if(!s)return u.value="No server connected",null;const y=e||a.value;if(!y.trim())return u.value="Query cannot be empty",null;c.value=!0,u.value=null;try{const r=await s.executeCypher(y),q={id:`query-${Date.now()}`,query:y,timestamp:new Date,executionTime:((f=r.data)==null?void 0:f.executionTime)||0,rowCount:((d=r.data)==null?void 0:d.rowCount)||0,success:r.success,error:r.error};return t.value.unshift(q),t.value.length>v&&(t.value=t.value.slice(0,v)),i(),r.success&&r.data?(l.value=r.data,r.data):(u.value=r.error||"Query execution failed",null)}catch(r){return u.value=r.message||"Query execution failed",null}finally{c.value=!1}}function x(e){a.value=e}function Q(){l.value=null,u.value=null}function T(){t.value=[],i()}function g(e){t.value=t.value.filter(n=>n.id!==e),i()}return{currentQuery:a,lastResult:l,isExecuting:c,error:u,history:t,recentQueries:S,executeQuery:h,setQuery:x,clearResult:Q,clearHistory:T,removeFromHistory:g}});export{C as u};
