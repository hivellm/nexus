import{d as D,u as H,r as d,c as E,p as O,f as U,a as n,b as t,e as k,z as L,A as z,B,C as Q,F as x,l as m,t as a,i as w,n as W,y as q,m as F,o}from"./index-DxjyOTWR.js";import{u as K}from"./query-BMzi8zRN.js";const J={class:"p-6 space-y-6"},G={class:"card"},X={class:"flex items-center gap-4"},Y={class:"flex-1"},Z=["value"],ee={class:"card"},te={class:"flex items-center justify-between mb-4"},se={class:"text-lg font-semibold"},le={key:0,class:"text-sm font-normal text-text-muted ml-2"},ne={class:"flex items-center gap-2"},oe={key:0,class:"overflow-x-auto"},ae={class:"table"},ie={class:"font-mono text-xs"},re={class:"flex flex-wrap gap-1"},ue={class:"text-sm"},de={class:"flex items-center gap-1"},ce=["onClick"],ve=["onClick"],fe={key:1,class:"text-center text-text-muted py-8"},pe={key:2,class:"flex items-center justify-between mt-4 pt-4 border-t border-border"},xe={class:"text-sm text-text-muted"},me={class:"flex items-center gap-2"},be=["disabled"],ye={class:"text-sm"},ge=["disabled"],he={class:"bg-bg-elevated rounded-lg p-6 w-full max-w-2xl max-h-[80vh] overflow-y-auto"},_e={class:"flex items-center justify-between mb-4"},ke={class:"space-y-4"},we={class:"grid grid-cols-2 gap-4"},Ce={class:"font-mono"},Se={class:"flex flex-wrap gap-1"},Ne={class:"p-4 bg-bg-tertiary rounded-lg font-mono text-sm overflow-x-auto"},Le=D({__name:"DataView",setup(Re){const A=F(),C=H(),M=K(),b=d([]),S=d([]),u=d(""),y=d(""),g=d(!1),r=d(1),p=d(25),c=d(0),v=d(null),N=E(()=>Math.ceil(c.value/p.value)),R=E(()=>{if(b.value.length===0)return[];const l=new Set;return b.value.forEach(e=>{Object.keys(e.properties).forEach(s=>l.add(s))}),Array.from(l).slice(0,5)});async function T(){const l=C.activeClient;if(!l)return;const e=await l.getLabels();e.success&&e.data&&(S.value=e.data.map(s=>s.name))}async function h(){const l=C.activeClient;if(l){g.value=!0;try{let e="MATCH (n";if(u.value&&(e+=`:${u.value}`),e+=")",y.value){const f=y.value.toLowerCase();e+=` WHERE any(prop IN keys(n) WHERE toLower(toString(n[prop])) CONTAINS '${f}')`}e+=" RETURN n",e+=` SKIP ${(r.value-1)*p.value}`,e+=` LIMIT ${p.value}`;const s=await l.executeCypher(e);s.success&&s.data&&(b.value=s.data.rows.map(f=>({id:f.n._nexus_id||f.n.id,labels:f.n._nexus_labels||f.n.labels||[],properties:V(f.n)})));let i="MATCH (n";u.value&&(i+=`:${u.value}`),i+=") RETURN count(n) AS count";const _=await l.executeCypher(i);_.success&&_.data&&_.data.rows.length>0&&(c.value=_.data.rows[0].count)}catch(e){console.error("Failed to load data:",e)}finally{g.value=!1}}}function V(l){const e={};for(const[s,i]of Object.entries(l))!s.startsWith("_nexus_")&&s!=="labels"&&s!=="id"&&(e[s]=i);return e}function $(){r.value=1,h()}function j(l){v.value=l}function P(l){M.setQuery(`MATCH (n)-[r]-(m) WHERE id(n) = ${l.id} RETURN n, r, m`),A.push("/graph")}function I(l){if(l==null)return"-";if(typeof l=="object")return JSON.stringify(l);const e=String(l);return e.length>50?e.substring(0,50)+"...":e}return O([u,r],()=>{h()}),U(()=>{T(),h()}),(l,e)=>(o(),n("div",J,[t("div",G,[t("div",X,[t("div",Y,[L(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>y.value=s),type:"text",class:"input",placeholder:"Search nodes by property value...",onKeydown:B($,["enter"])},null,544),[[z,y.value]])]),L(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>u.value=s),class:"input w-48"},[e[6]||(e[6]=t("option",{value:""},"All Labels",-1)),(o(!0),n(x,null,m(S.value,s=>(o(),n("option",{key:s,value:s},a(s),9,Z))),128))],512),[[Q,u.value]]),t("button",{onClick:$,class:"btn btn-primary"},[...e[7]||(e[7]=[t("i",{class:"fas fa-search mr-1"},null,-1),w(" Search ",-1)])])])]),t("div",ee,[t("div",te,[t("h3",se,[w(a(u.value?`Nodes: ${u.value}`:"All Nodes")+" ",1),c.value>0?(o(),n("span",le," ("+a(c.value)+" total) ",1)):k("",!0)]),t("div",ne,[t("button",{onClick:h,class:"btn btn-secondary text-xs"},[t("i",{class:W(["fas mr-1",g.value?"fa-spinner fa-spin":"fa-sync"])},null,2),e[8]||(e[8]=w(" Refresh ",-1))])])]),b.value.length>0?(o(),n("div",oe,[t("table",ae,[t("thead",null,[t("tr",null,[e[9]||(e[9]=t("th",null,"ID",-1)),e[10]||(e[10]=t("th",null,"Labels",-1)),(o(!0),n(x,null,m(R.value,s=>(o(),n("th",{key:s},a(s),1))),128)),e[11]||(e[11]=t("th",null,"Actions",-1))])]),t("tbody",null,[(o(!0),n(x,null,m(b.value,s=>(o(),n("tr",{key:s.id},[t("td",ie,a(s.id),1),t("td",null,[t("div",re,[(o(!0),n(x,null,m(s.labels,i=>(o(),n("span",{key:i,class:"px-2 py-0.5 bg-info/20 text-info rounded text-xs"},a(i),1))),128))])]),(o(!0),n(x,null,m(R.value,i=>(o(),n("td",{key:i},[t("span",ue,a(I(s.properties[i])),1)]))),128)),t("td",null,[t("div",de,[t("button",{onClick:i=>j(s),class:"p-1 text-text-muted hover:text-accent",title:"View details"},[...e[12]||(e[12]=[t("i",{class:"fas fa-eye"},null,-1)])],8,ce),t("button",{onClick:i=>P(s),class:"p-1 text-text-muted hover:text-success",title:"View relationships"},[...e[13]||(e[13]=[t("i",{class:"fas fa-project-diagram"},null,-1)])],8,ve)])])]))),128))])])])):g.value?k("",!0):(o(),n("div",fe,[...e[14]||(e[14]=[t("i",{class:"fas fa-database text-2xl mb-2"},null,-1),t("p",null,"No nodes found",-1)])])),c.value>p.value?(o(),n("div",pe,[t("div",xe," Showing "+a((r.value-1)*p.value+1)+" - "+a(Math.min(r.value*p.value,c.value))+" of "+a(c.value),1),t("div",me,[t("button",{onClick:e[2]||(e[2]=s=>r.value--),disabled:r.value===1,class:"btn btn-secondary text-xs"},[...e[15]||(e[15]=[t("i",{class:"fas fa-chevron-left"},null,-1)])],8,be),t("span",ye,"Page "+a(r.value)+" of "+a(N.value),1),t("button",{onClick:e[3]||(e[3]=s=>r.value++),disabled:r.value===N.value,class:"btn btn-secondary text-xs"},[...e[16]||(e[16]=[t("i",{class:"fas fa-chevron-right"},null,-1)])],8,ge)])])):k("",!0)]),v.value?(o(),n("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:e[5]||(e[5]=q(s=>v.value=null,["self"]))},[t("div",he,[t("div",_e,[e[18]||(e[18]=t("h3",{class:"text-lg font-semibold"},"Node Details",-1)),t("button",{onClick:e[4]||(e[4]=s=>v.value=null),class:"text-text-muted hover:text-text-primary"},[...e[17]||(e[17]=[t("i",{class:"fas fa-times"},null,-1)])])]),t("div",ke,[t("div",we,[t("div",null,[e[19]||(e[19]=t("div",{class:"text-sm text-text-muted mb-1"},"ID",-1)),t("div",Ce,a(v.value.id),1)]),t("div",null,[e[20]||(e[20]=t("div",{class:"text-sm text-text-muted mb-1"},"Labels",-1)),t("div",Se,[(o(!0),n(x,null,m(v.value.labels,s=>(o(),n("span",{key:s,class:"px-2 py-0.5 bg-info/20 text-info rounded text-xs"},a(s),1))),128))])])]),t("div",null,[e[21]||(e[21]=t("div",{class:"text-sm text-text-muted mb-2"},"Properties",-1)),t("pre",Ne,a(JSON.stringify(v.value.properties,null,2)),1)])])])])):k("",!0)]))}});export{Le as default};
