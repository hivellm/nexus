import{d as U,m as V,r as S,e as f,f as z,c as r,a as e,b as d,k as c,n as p,t as i,w as B,v as F,p as K,q as D,F as h,j as k,o}from"./index-BNyczF3N.js";import{u as I}from"./query-CczXuno5.js";const A={class:"flex flex-col h-full"},P={class:"flex-shrink-0 border-b border-border bg-bg-secondary"},G={class:"p-4"},W={class:"flex items-center justify-between mb-2"},X={class:"flex items-center gap-2"},Y=["disabled"],Z=["disabled"],ee={class:"h-40 rounded-lg overflow-hidden border border-border bg-bg-tertiary"},te=["onKeydown"],se={class:"flex items-center justify-between mt-2 text-xs text-text-muted"},re={key:0},oe={class:"flex-1 flex flex-col min-h-0 p-4"},ne={key:0,class:"mb-4 p-4 bg-error/10 border border-error rounded-lg"},le={class:"mt-1 text-sm text-error/80"},ie={key:1,class:"flex items-center justify-between mb-4"},ae={class:"flex items-center gap-4"},de={class:"flex items-center gap-2"},ue={class:"text-sm text-text-muted"},ce={class:"flex items-center gap-2"},xe={key:2,class:"flex-1 overflow-auto bg-bg-secondary border border-border rounded-lg"},be={class:"min-w-full divide-y divide-border"},ye={class:"bg-bg-tertiary sticky top-0"},fe={class:"divide-y divide-border"},ve={key:0,class:"font-mono text-xs text-text-secondary"},me={key:1},pe={key:3,class:"flex-1 overflow-auto"},ge={class:"p-4 bg-bg-tertiary rounded-lg font-mono text-sm text-text-primary overflow-auto h-full border border-border"},he={key:4,class:"flex-1 flex items-center justify-center"},ke={key:0,class:"fixed right-0 top-0 bottom-0 w-96 bg-bg-secondary border-l border-border p-4 z-50 shadow-lg"},_e={class:"flex items-center justify-between mb-4"},we={class:"flex items-center gap-2"},Ce={class:"space-y-2 overflow-y-auto h-full pb-20"},je=["onClick"],Qe={class:"font-mono text-xs text-text-primary truncate"},Ee={class:"flex items-center justify-between mt-1 text-xs"},Ne={class:"flex items-center gap-2 text-text-muted"},Re={key:0,class:"text-center text-text-muted py-8"},He=U({__name:"QueryView",setup(Se){const a=I(),_=V(),x=S("table"),b=S(!1),g=f({get:()=>a.currentQuery,set:l=>a.setQuery(l)}),n=f(()=>a.lastResult),w=f(()=>a.isExecuting),C=f(()=>a.error),j=f(()=>a.history),Q=f(()=>{var l;return(l=n.value)==null?void 0:l.executionTime});async function E(){const l=await a.executeQuery();l&&_.success("Query executed",`${l.rowCount} rows returned`)}function $(){a.setQuery(""),a.clearResult()}function T(){a.clearHistory(),_.info("History cleared","Query history has been cleared")}function H(l){a.setQuery(l),b.value=!1}function O(l){return l!==null&&typeof l=="object"}function N(l){if(!n.value)return;let t,s,y;if(l==="json")t=JSON.stringify(n.value.rows,null,2),s="query-results.json",y="application/json";else{const q=n.value.columns.join(","),J=n.value.rows.map(L=>n.value.columns.map(M=>{const m=L[M];return typeof m=="string"?`"${m.replace(/"/g,'""')}"`:typeof m=="object"?`"${JSON.stringify(m).replace(/"/g,'""')}"`:m}).join(","));t=[q,...J].join(`
`),s="query-results.csv",y="text/csv"}const u=new Blob([t],{type:y}),R=URL.createObjectURL(u),v=document.createElement("a");v.href=R,v.download=s,document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(R),_.success("Export complete",`Results saved as ${s}`)}return z(()=>{}),(l,t)=>(o(),r("div",A,[e("div",P,[e("div",G,[e("div",W,[t[10]||(t[10]=e("h3",{class:"text-sm font-medium text-text-secondary"},"Cypher Query",-1)),e("div",X,[e("button",{onClick:t[0]||(t[0]=s=>b.value=!0),class:"px-3 py-1.5 text-xs font-medium text-text-secondary bg-bg-tertiary border border-border rounded-lg hover:bg-bg-hover hover:text-text-primary transition-colors",title:"Query History"},[...t[8]||(t[8]=[e("i",{class:"fas fa-history mr-1"},null,-1),c("History ",-1)])]),e("button",{onClick:$,class:"px-3 py-1.5 text-xs font-medium text-text-secondary bg-bg-tertiary border border-border rounded-lg hover:bg-bg-hover hover:text-text-primary transition-colors disabled:opacity-50",disabled:!g.value},[...t[9]||(t[9]=[e("i",{class:"fas fa-trash mr-1"},null,-1),c("Clear ",-1)])],8,Y),e("button",{onClick:E,class:"px-4 py-1.5 text-sm font-medium text-text-primary bg-bg-tertiary border border-border rounded-lg hover:bg-bg-hover transition-colors disabled:opacity-50",disabled:w.value||!g.value.trim()},[e("i",{class:p(["fas mr-1",w.value?"fa-spinner fa-spin":"fa-play"])},null,2),c(" "+i(w.value?"Executing...":"Run Query"),1)],8,Z)])]),e("div",ee,[B(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=s=>g.value=s),class:"w-full h-full bg-transparent text-text-primary font-mono text-sm p-3 resize-none focus:outline-none placeholder-text-muted",placeholder:"MATCH (n) RETURN n LIMIT 25",onKeydown:K(D(E,["ctrl"]),["enter"])},null,40,te),[[F,g.value]])]),e("div",se,[t[11]||(t[11]=e("span",null,"Press Ctrl+Enter to execute",-1)),Q.value?(o(),r("span",re,"Last execution: "+i(Q.value)+"ms",1)):d("",!0)])])]),e("div",oe,[C.value?(o(),r("div",ne,[t[12]||(t[12]=e("div",{class:"flex items-center gap-2 text-error"},[e("i",{class:"fas fa-exclamation-circle"}),e("span",{class:"font-medium"},"Query Error")],-1)),e("p",le,i(C.value),1)])):d("",!0),n.value?(o(),r("div",ie,[e("div",ae,[e("div",de,[e("button",{onClick:t[2]||(t[2]=s=>x.value="table"),class:p(["px-3 py-1 rounded text-sm transition-colors",x.value==="table"?"bg-bg-tertiary text-text-primary border border-border":"bg-transparent text-text-secondary hover:text-text-primary"])},[...t[13]||(t[13]=[e("i",{class:"fas fa-table mr-1"},null,-1),c("Table ",-1)])],2),e("button",{onClick:t[3]||(t[3]=s=>x.value="json"),class:p(["px-3 py-1 rounded text-sm transition-colors",x.value==="json"?"bg-bg-tertiary text-text-primary border border-border":"bg-transparent text-text-secondary hover:text-text-primary"])},[...t[14]||(t[14]=[e("i",{class:"fas fa-code mr-1"},null,-1),c("JSON ",-1)])],2)]),e("span",ue,i(n.value.rowCount)+" rows in "+i(n.value.executionTime)+"ms ",1)]),e("div",ce,[e("button",{onClick:t[4]||(t[4]=s=>N("json")),class:"px-3 py-1.5 text-xs font-medium text-text-secondary bg-bg-tertiary border border-border rounded-lg hover:bg-bg-hover hover:text-text-primary transition-colors"},[...t[15]||(t[15]=[e("i",{class:"fas fa-download mr-1"},null,-1),c("Export JSON ",-1)])]),e("button",{onClick:t[5]||(t[5]=s=>N("csv")),class:"px-3 py-1.5 text-xs font-medium text-text-secondary bg-bg-tertiary border border-border rounded-lg hover:bg-bg-hover hover:text-text-primary transition-colors"},[...t[16]||(t[16]=[e("i",{class:"fas fa-file-csv mr-1"},null,-1),c("Export CSV ",-1)])])])])):d("",!0),n.value&&x.value==="table"?(o(),r("div",xe,[e("table",be,[e("thead",ye,[e("tr",null,[(o(!0),r(h,null,k(n.value.columns,s=>(o(),r("th",{key:s,class:"px-4 py-3 text-left text-xs font-medium text-text-muted uppercase tracking-wider"},i(s),1))),128))])]),e("tbody",fe,[(o(!0),r(h,null,k(n.value.rows,(s,y)=>(o(),r("tr",{key:y,class:"hover:bg-bg-hover transition-colors"},[(o(!0),r(h,null,k(n.value.columns,u=>(o(),r("td",{key:u,class:"px-4 py-3 text-sm text-text-primary"},[O(s[u])?(o(),r("span",ve,i(JSON.stringify(s[u]).substring(0,100))+i(JSON.stringify(s[u]).length>100?"...":""),1)):(o(),r("span",me,i(s[u]),1))]))),128))]))),128))])])])):d("",!0),n.value&&x.value==="json"?(o(),r("div",pe,[e("pre",ge,i(JSON.stringify(n.value.rows,null,2)),1)])):d("",!0),!n.value&&!C.value?(o(),r("div",he,[...t[17]||(t[17]=[e("div",{class:"text-center text-text-muted"},[e("i",{class:"fas fa-terminal text-4xl mb-4 block"}),e("p",null,"Enter a Cypher query and click Run to see results")],-1)])])):d("",!0)]),b.value?(o(),r("div",ke,[e("div",_e,[t[19]||(t[19]=e("h3",{class:"font-semibold text-text-primary"},"Query History",-1)),e("div",we,[e("button",{onClick:T,class:"text-xs text-text-muted hover:text-error",title:"Clear History"}," Clear "),e("button",{onClick:t[6]||(t[6]=s=>b.value=!1),class:"text-text-muted hover:text-text-primary"},[...t[18]||(t[18]=[e("i",{class:"fas fa-times"},null,-1)])])])]),e("div",Ce,[(o(!0),r(h,null,k(j.value,s=>(o(),r("div",{key:s.id,class:"p-3 bg-bg-tertiary border border-border rounded-lg cursor-pointer hover:bg-bg-hover transition-colors group",onClick:y=>H(s.query)},[e("div",Qe,i(s.query),1),e("div",Ee,[e("div",Ne,[e("span",{class:p(s.success?"text-success":"text-error")},[e("i",{class:p(["fas",s.success?"fa-check":"fa-times"])},null,2)],2),e("span",null,i(s.rowCount)+" rows",1),e("span",null,i(s.executionTime)+"ms",1)])])],8,je))),128)),j.value.length===0?(o(),r("div",Re,[...t[20]||(t[20]=[e("i",{class:"fas fa-history text-2xl mb-3 block"},null,-1),e("p",null,"No query history yet",-1)])])):d("",!0)])])):d("",!0),b.value?(o(),r("div",{key:1,class:"fixed inset-0 bg-black/20 z-40",onClick:t[7]||(t[7]=s=>b.value=!1)})):d("",!0)]))}});export{He as default};
